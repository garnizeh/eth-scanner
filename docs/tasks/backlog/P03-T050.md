# P03-T050: Create GET /health endpoint

**Phase:** P03 - Master API - Core Infrastructure  
**Status:** Not Started  
**Priority:** High  
**Dependencies:** P03-T040  
**Estimated Effort:** Small

---

## Description

Implement a basic health check endpoint (`GET /health`) that returns server status and optionally database connectivity status. This endpoint is essential for monitoring and load balancer health checks.

## Acceptance Criteria

- [ ] Handler function for `/health` endpoint exists in `go/internal/server/handlers.go` or `health.go`
- [ ] Endpoint returns HTTP 200 OK when healthy
- [ ] Response includes JSON payload with status and timestamp (UTC)
- [ ] Optionally checks database connectivity (ping)
- [ ] Returns appropriate error status if database is unreachable
- [ ] Handler is registered in routes.go

## Implementation Notes

**Handler Function:**
```go
func (s *Server) HandleHealth(w http.ResponseWriter, r *http.Request) {
    // Check database connectivity (optional but recommended)
    // Return health status as JSON
}
```

**Response Format:**
```json
{
  "status": "ok",
  "timestamp": "2026-02-14T12:34:56Z",
  "database": "connected"
}
```

**Error Response:**
If database is unreachable:
```json
{
  "status": "error",
  "timestamp": "2026-02-14T12:34:56Z",
  "database": "disconnected",
  "error": "database connection failed"
}
```
Return HTTP 503 Service Unavailable.

**Time Handling:**
Use `time.Now().UTC()` for timestamp (per time handling guidelines).

**Database Ping:**
```go
ctx, cancel := context.WithTimeout(r.Context(), 2*time.Second)
defer cancel()
err := s.db.PingContext(ctx)
```

**Content Type:**
Always set `Content-Type: application/json` header.

## Testing

```bash
cd /home/user/code/garnizeh/eth-scanner/go

# Manual test after server is running
curl http://localhost:8080/health
```

Expected output:
```json
{"status":"ok","timestamp":"2026-02-14T12:34:56Z","database":"connected"}
```

Unit test:
- Test handler with healthy database
- Test handler with database error
- Verify JSON response format
- Verify UTC timestamp format

## References

- SDD: `docs/architecture/system-design-document.md`
- Copilot Instructions: Go Code Style - Time Handling (always UTC)
- Related tasks: P03-T040 (routes.go), P03-T070 (manual testing)
