# P03-T040: Implement internal/server/routes.go

**Phase:** P03 - Master API - Core Infrastructure  
**Status:** Not Started  
**Priority:** High  
**Dependencies:** P03-T020  
**Estimated Effort:** Small

---

## Description

Create the route registration module for the Master API. This module will define all API routes and wire them to their respective handlers. Initially, it will only register placeholder routes, with actual handlers implemented in Phase 4.

## Acceptance Criteria

- [ ] File `go/internal/server/routes.go` exists
- [ ] `RegisterRoutes()` function implemented
- [ ] Route registration uses middleware from P03-T030
- [ ] All routes follow REST conventions and API versioning (`/api/v1/...`)
- [ ] Code is clean and well-organized
- [ ] Placeholder handlers defined (can return 501 Not Implemented initially)

## Implementation Notes

**Route Registration Function:**
```go
func (s *Server) RegisterRoutes() {
    // Apply global middleware
    // Register routes with handlers
}
```

**API Routes (Placeholders for now):**
```
GET  /health                      → Health check (P03-T050)
POST /api/v1/jobs/lease           → Lease a job batch (P04-T050)
PATCH /api/v1/jobs/{id}/checkpoint → Update checkpoint (P04-T070)
POST /api/v1/jobs/{id}/complete   → Complete a job (P04-T090)
POST /api/v1/results              → Submit found key (P04-T110)
GET  /api/v1/stats                → Get statistics (P04-T120)
```

**Middleware Chain:**
Apply middleware in order:
1. RequestID (if implemented)
2. Logger
3. CORS

**Handler Stubs:**
For routes not yet implemented, return:
```go
http.Error(w, "Not Implemented", http.StatusNotImplemented)
```

**Router Organization:**
- Group routes by version (`/api/v1`)
- Use consistent naming conventions
- Keep route definitions in one place for easy overview

## Testing

```bash
cd /home/user/code/garnizeh/eth-scanner/go
go test ./internal/server/...
```

Manual verification:
- All routes are registered correctly
- Middleware is applied to all routes
- Placeholder handlers return 501 for unimplemented routes

## References

- SDD: `docs/architecture/system-design-document.md` (API Endpoints section)
- Related tasks: P03-T020 (server.go), P03-T030 (middleware.go), P03-T050 (health endpoint)
- Future tasks: P04-T050, P04-T070, P04-T090, P04-T110, P04-T120 (actual handlers)
