# P03-T020: Implement internal/api/server.go

**Phase:** P03 - Master API - Core Infrastructure  
**Status:** Not Started  
**Priority:** High  
**Dependencies:** P03-T010  
**Estimated Effort:** Medium

---

## Description

Implement the HTTP server setup for the Master API using `net/http` or `chi` router. The server should be configurable, support graceful shutdown, and provide a clean foundation for adding routes.

## Acceptance Criteria

- [ ] File `go/internal/api/server.go` exists
- [ ] `Server` struct defined with router and configuration dependencies
- [ ] `NewServer()` constructor function implemented
- [ ] HTTP server configured to listen on configured port
- [ ] Server supports graceful shutdown via context
- [ ] All code follows Go best practices and idiomatic patterns

## Implementation Notes

**Server Structure:**
```go
type Server struct {
    router http.Handler
    config *config.Config
    db     *database.DB
}

func NewServer(cfg *config.Config, db *database.DB) *Server {
    // Initialize router (net/http.ServeMux or chi.Router)
    // Return server instance
}

func (s *Server) Start(ctx context.Context) error {
    // Start HTTP server
    // Listen for context cancellation for graceful shutdown
}
```

**Router Choice:**
Prefer `net/http.ServeMux` for simplicity (MVP requirement). Can upgrade to `chi` later if needed.

**Port Binding:**
- Use `cfg.Port` from config
- Default to `:8080` if not specified
- Log startup message with actual listening address

**Context Usage:**
All long-running operations must use `context.Context` for cancellation and timeouts (per Go code style guidelines).

## Testing

```bash
cd /home/user/code/garnizeh/eth-scanner/go
go test ./internal/api/...
```

Manual verification:
- Server starts successfully
- Server listens on configured port
- Server logs startup message
- Server responds to basic HTTP requests (after routes added)

## References

- SDD: `docs/architecture/system-design-document.md` (Master API section)
- Copilot Instructions: Go Code Style - Context usage
- Related tasks: P03-T010 (config), P03-T040 (routes), P03-T060 (main.go)
