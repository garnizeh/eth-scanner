# P04-T110: Create POST /api/v1/results handler (submit found private key)

**Phase:** P04 - Master API - Job Management (Dynamic Batching)  
**Status:** Not Started  
**Priority:** Medium  
**Dependencies:** P04-T010, P02-T040  
**Estimated Effort:** Medium (1-3h)

---

## Description

Implement the results submission endpoint that allows workers to report when they find a private key that generates the target Ethereum address. This is the ultimate goal of the scanning system.

---

## Acceptance Criteria

- [ ] Handler `handleResultSubmit` implemented
- [ ] Accepts POST request to `/api/v1/results`
- [ ] Request body: `{"worker_id": "...", "job_id": 123, "private_key": "hex", "address": "0x...", "nonce": 12345}`
- [ ] Validates private key format (64 hex chars = 32 bytes)
- [ ] Validates Ethereum address format (42 chars, starts with 0x)
- [ ] Inserts result into `results` table with found_at timestamp (UTC)
- [ ] Optionally marks associated job as completed
- [ ] Returns 201 Created with result record
- [ ] Returns 400 Bad Request for validation errors
- [ ] Route registered in `routes.go`

---

## Implementation Notes

**Key Points:**
- Reference SDD: Results table stores found keys
- This is a rare event â€” most jobs won't find matches
- Consider logging result submission to stdout for immediate visibility
- Security: Be cautious about logging private keys in production

**Request Schema:**
```json
{
  "worker_id": "worker-pc-001",
  "job_id": 123,
  "private_key": "abcdef0123456789...",  // 64 hex chars
  "address": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
  "nonce": 50000
}
```

**Response Schema:**
```json
{
  "result_id": 1,
  "job_id": 123,
  "private_key": "abcdef...",
  "address": "0x742d35Cc...",
  "found_at": "2026-02-15T15:45:00Z",
  "message": "Private key found! ðŸŽ‰"
}
```

**SQL Insert:**
```sql
INSERT INTO results (
    job_id, worker_id, private_key, address, nonce, found_at
) VALUES (?, ?, ?, ?, ?, ?);
```

---

## Testing

- Test valid result submission
- Test invalid private key format (too short, non-hex)
- Test invalid address format
- Test duplicate submission (same private key)
- Verify found_at timestamp is UTC

---

## References

- SDD: Section 3.2 â€” Results table schema
- Database: `docs/database/schema.sql` (results table)
- Security: Handle private keys carefully
