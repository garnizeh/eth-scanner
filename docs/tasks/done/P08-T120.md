# P08-T120: Validate NVS recovery and Task Watchdog (TWDT) resilience under 100% CPU load.

**Phase:** P08 - ESP32 Worker - Crypto & Computation  
**Status:** Completed  
**Priority:** High  
**Dependencies:** P07-T070, P08-T080  
**Estimated Effort:** Medium

---

## Description

Ensure that the system remains stable under full CPU load on Core 1 and that the Task Watchdog does not trigger erroneously. Also, verify that the NVS recovery mechanism correctly resumes work after a simulated power failure.

## Acceptance Criteria

- [x] Core 1 task correctly yields to or interacts with the Watchdog if necessary (e.g., calling `esp_task_wdt_reset()` or yielding via `vTaskDelay(1)`).
- [x] Simulate power loss by resetting the ESP32 mid-job and verify it resumes from the last NVS checkpoint.
- [x] System remains connected to WiFi even while Core 1 is at 100% load.

## Implementation Notes

- Core 1 yields to Watchdog via `vTaskDelay(1)` every 1024 iterations in the hot loop.
- Core 0 (System Core) handles the watchdog through the normal FreeRTOS IDLE task or manual yielding.
- App boot logic checks for an existing NVS checkpoint and resumes the job before entering the main loop.

## Testing

- Verified with `test_recovery_logic_resumption` which simulates a reset and confirms state restoration.
- 29/29 tests PASS including long benchmarks.

## References

- SDD: Job Lifecycle section.
- OVERVIEW: Technical Notes (Dual-Core Logic).
