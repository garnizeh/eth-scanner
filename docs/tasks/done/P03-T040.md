# P03-T040: Implement internal/server/routes.go — Done

**Phase:** P03 - Master API - Core Infrastructure  
**Status:** Done  
**Priority:** High  
**Dependencies:** P03-T020  
**Estimated Effort:** Small

---

## Summary

Implemented the route registration module for the Master API and added placeholder handlers that return 501 Not Implemented. Applied the middleware chain (RequestID → Logger → CORS) to the router and added a dedicated health handler file.

## Acceptance Criteria (completed)

- [x] File `go/internal/server/routes.go` exists
- [x] `RegisterRoutes()` function implemented
- [x] Route registration uses middleware from P03-T030 (RequestID → Logger → CORS)
- [x] All routes follow REST conventions and API versioning (`/api/v1/...`)
- [x] Code is clean and well-organized
- [x] Placeholder handlers defined (return 501 Not Implemented)

## Changes made

- Added `go/internal/server/routes.go` — registers routes and sets `s.handler = RequestID(Logger(CORS(s.router)))`.
- Added `go/internal/server/health.go` — moved `handleHealth` into its own file.
- Updated `go/internal/server/server.go` — added `handler http.Handler` field and made `Start` use `s.handler` when set (falls back to `s.router`).
- Added `go/internal/server/health_test.go` — tests `handleHealth` behavior.

## Tests

- Ran package tests for `internal/server`. `TestHandleHealth` and the new `TestHandleHealth_File` pass locally.

## Notes

- Routes are placeholders and return 501 until the handlers are implemented in Phase 4.
- Middleware order is applied globally by wrapping the `ServeMux`.

---

Acceptance verified by code changes and running `go test ./internal/server -run TestHandleHealth -v`.
