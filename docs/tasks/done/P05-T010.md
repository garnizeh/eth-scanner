# P05-T010: Implement internal/worker/config.go

**Phase:** P05 - PC Worker - Core Implementation  
**Status:** Completed  
**Priority:** High  
**Dependencies:** None  
**Estimated Effort:** Small

---

## Description

Create the configuration management module for the PC worker. This module will handle loading and validating worker configuration from environment variables or configuration files, including API URL, worker ID, and API key for authentication.

## Acceptance Criteria

- [x] File `go/internal/worker/config.go` exists
- [x] `Config` struct defined with fields:
  - `APIURL` (string) - Master API base URL
  - `WorkerID` (string) - Unique identifier for this worker
  - `APIKey` (string) - API key for authenticating with Master API (optional)
  - `CheckpointInterval` (time.Duration) - How often to send checkpoints (default: 5 minutes)
- [x] `LoadConfig()` function reads from environment variables:
  - `WORKER_API_URL` (required)
  - `WORKER_ID` (required, or auto-generate using hostname+random)
  - `WORKER_API_KEY` (optional â€” worker may operate without it; API will enforce auth if required)
  - `WORKER_CHECKPOINT_INTERVAL` (optional, default: "5m")
- [x] Configuration validation implemented (non-empty required fields, valid URL format)
- [x] Error handling with descriptive messages for missing/invalid config
- [x] Follow Go idioms (use `time.Duration` for intervals)

## Implementation Notes

### Config Structure
```go
package worker

import "time"

type Config struct {
    APIURL             string
    WorkerID           string
    APIKey             string
    CheckpointInterval time.Duration
}

func LoadConfig() (*Config, error) {
    // Read from environment
    // Validate required fields
    // Set defaults for optional fields
    // Return config or error
}
```

### Environment Variables
- `WORKER_API_URL`: e.g., `http://localhost:8080`
- `WORKER_ID`: e.g., `worker-pc-001` or auto-generated
- `WORKER_API_KEY`: e.g., `sk_test_1234567890abcdef` (optional)
- `WORKER_CHECKPOINT_INTERVAL`: e.g., `5m`, `300s`

### Auto-Generation of Worker ID
If `WORKER_ID` is not provided, generate one using hostname and random bytes.

## Testing

```bash
cd /home/user/code/garnizeh/eth-scanner/go
# Set environment variables
export WORKER_API_URL="http://localhost:8080"
export WORKER_ID="test-worker-001"
export WORKER_API_KEY="sk_test_abc123" # optional

# Run tests
go test ./internal/worker -v -run TestLoadConfig
```

### Test Cases
- Valid configuration loads successfully
- Missing required fields return errors
- Invalid URL format returns error
- Default checkpoint interval is 5 minutes
- Custom checkpoint interval is parsed correctly
- Auto-generated worker ID when not provided

## References

- SDD: `docs/architecture/system-design-document.md` (Section 4: API Design)
- Related tasks: P05-T020 (uses this config)
- Go stdlib: `os`, `time`, `net/url` for validation
