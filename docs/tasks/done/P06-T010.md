# P06-T010: Implement crypto.go with go-ethereum imports

**Phase:** P06 - PC Worker - Crypto & Scanning Engine  
**Status:** Completed  
**Priority:** High  
**Dependencies:** None  
**Estimated Effort:** Small (< 1h)

**Completed:** 2026-02-15
**Summary:** Implemented `internal/worker/crypto.go` with `DeriveEthereumAddress` using `github.com/ethereum/go-ethereum/crypto`. Added unit tests and verified the package builds and tests pass.

---

## Description

Create `internal/worker/crypto.go` file and import the required cryptographic libraries from `github.com/ethereum/go-ethereum/crypto`. This establishes the foundation for Ethereum key generation and address derivation in the PC worker.

---

## Acceptance Criteria

- [x] File `go/internal/worker/crypto.go` created with package declaration
- [x] Import `github.com/ethereum/go-ethereum/crypto` successfully
- [x] Import `github.com/ethereum/go-ethereum/common` for address types
- [x] Add dependency to `go.mod` (run `go get github.com/ethereum/go-ethereum`)
- [x] File compiles without errors (`go build ./internal/worker`)

---

## Implementation Notes

**Key Points:**
- `DeriveEthereumAddress(privateKey [32]byte) (common.Address, error)` implemented using `crypto.ToECDSA` and `crypto.PubkeyToAddress`.
- Unit tests added in `go/internal/worker/crypto_test.go` covering a generated key and an invalid (zero) key.
- Verified tests: `go test ./internal/worker -run TestDeriveEthereumAddress -v` passed locally.

**Code Structure:**
```go
package worker

import (
    "fmt"

    "github.com/ethereum/go-ethereum/common"
    "github.com/ethereum/go-ethereum/crypto"
)

func DeriveEthereumAddress(privateKey [32]byte) (common.Address, error) {
    pk, err := crypto.ToECDSA(privateKey[:])
    if err != nil {
        return common.Address{}, fmt.Errorf("invalid private key: %w", err)
    }
    return crypto.PubkeyToAddress(pk.PublicKey), nil
}
```

---

## Testing / Verification

- Ran `go get github.com/ethereum/go-ethereum` and build verification
- Ran unit tests: `go test ./internal/worker -run TestDeriveEthereumAddress -v` â†’ PASS

---

## References

- SDD: `docs/architecture/system-design-document.md` (Section 4.3)
- Related tasks: P06-T020
