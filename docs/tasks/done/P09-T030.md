# P09-T030: Write unit tests for nonce range allocation logic

**Phase:** P09 - Integration, Testing & Validation  
**Status:** Completed
**Priority:** High  
**Dependencies:** P04-T030  
**Estimated Effort:** Medium

---

## Description

Verify the mathematical correctness of how nonce ranges are split and allocated to different workers (PC and ESP32).

## Acceptance Criteria

- [x] Test `GetNextNonceRange` (equivalent to `CalculateNextRange`) for sequential ranges without gaps.
- [x] Test allocation with different requested batch sizes.
- [x] Test the rollover case when the `prefix_28` is exhausted.

## Implementation Notes

- Focus on the logic in `internal/jobs/manager.go` related to nonce math.
- Use table-driven tests for multiple allocation scenarios.

## Testing

- Run dedicated Go tests: `go test -v ./internal/jobs -run "(GetNextNonceRange|CreateBatch)"`

## References

- OVERVIEW: Phase 09 section.
